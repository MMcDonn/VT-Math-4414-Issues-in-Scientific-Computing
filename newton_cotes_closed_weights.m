function w = newton_cotes_closed_weights(a, b, n)
cn = zeros(1, n+1);

if n == 1
    cn(1) = 1/2; cn(2) = cn(1);
elseif n == 2
    cn(1) = 1/6; cn(2) = 4/6; cn(3) = cn(1);
elseif n == 3
    cn(1) = 1/8; cn(2) = 3/8; cn(3) = cn(2); cn(4) = cn(1);
elseif n == 4
    cn(1) = 7/90; cn(2) = 16/45; cn(3) = 2/15;
    cn(4) = cn(2); cn(5) = cn(1);
elseif n == 5
    cn(1) = 19/288; cn(2) = 25/96; cn(3) = 25/144; cn(4) = 25/144; 
    cn(5) = 25/96; cn(6) = 19/288;
elseif n == 6
    cn(1) = 41/840; cn(2) = 9/35; cn(3) = 9/280; cn(4) = 34/105; 
    cn(5) = 9/280; cn(6) = 9/35; cn(7) = 41/840;
elseif n == 7
    cn(1) = 751/17280; cn(2) = 3577/17280; cn(3) = 49/640;
    cn(4) = 2989/17280; cn(5) = 2989/17280; cn(6) = 49/640;
    cn(7) = 3577/17280; cn(8) = 751/17280;
elseif n == 8
    cn(1) = 989/28350; cn(2) = 2944/14175; cn(3) = -(464/14175); 
    cn(4) = 5248/14175; cn(5) = -(454/2835); cn(6) = 5248/14175; 
    cn(7) = -(464/14175); cn(8) = 2944/14175; cn(9) = 989/28350;
elseif n == 9
    cn(1) = 2857/89600; cn(2) = 15741/89600; cn(3) = 27/2240;
    cn(4) = 1209/5600; cn(5) = 2889/44800; cn(6) = 2889/44800;
    cn(7) = 1209/5600; cn(8) = 27/2240; cn(9) = 15741/89600;
    cn(10) = 2857/89600;
elseif n == 10;
    cn(1) = 16067/598752; cn(2) = 26575/149688; cn(3) = -(16175/199584);
    cn(4) = 5675/12474; cn(5) = -(4825/11088); cn(6) = 17807/24948;
    cn(7) = -(4825/11088); cn(8) = 5675/12474; cn(9) = -(16175/199584);
    cn(10) = 26575/149688; cn(11) = 16067/598752;
end
%phew
w = (b-a)*cn;
return;